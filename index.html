<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KI Text Erkennung</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; text-align: center; color: #333; }
        .hidden { display: none; }
        button { 
            padding: 15px 30px; 
            font-size: 18px; 
            margin: 10px; 
            cursor: pointer; 
            background-color: #007bff; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            transition: background 0.3s;
        }
        button:hover { background-color: #0056b3; }
        .box { border: 1px solid #ddd; padding: 30px; border-radius: 12px; background: #f9f9f9; box-shadow: 0 4px 8px rgba(0,0,0,0.05); }
        select, input[type="text"] { padding: 10px; font-size: 16px; width: 80%; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
        .text-display {
            background: white; 
            padding: 20px; 
            border: 1px solid #eee; 
            margin: 20px 0; 
            text-align: left; 
            line-height: 1.6;
            font-size: 17px;
            white-space: pre-wrap; /* Keeps paragraphs/formatting */
        }
        h2 { margin-top: 0; }
    </style>
</head>
<body>

    <!-- STEP 1: DEMOGRAPHICS (GERMAN) -->
    <div id="step-demographics" class="box">
        <h2>Über Dich</h2>
        <p>Bitte wähle die Option, die am besten auf dich zutrifft:</p>
        
        <select id="role-select" onchange="checkOther()">
            <option value="" disabled selected>Bitte auswählen...</option>
            <option value="Language Teacher">Sprachlehrer/in (z.B. Englisch, Deutsch, Französisch)</option>
            <option value="Non-Language Teacher">Lehrer/in (andere Fächer)</option>
            <option value="Student">Schüler/in oder Student/in</option>
            <option value="Other">Sonstiges</option>
        </select>
        
        <div id="other-input-div" class="hidden" style="margin-top: 10px;">
            <input type="text" id="other-text" placeholder="Bitte hier eingeben...">
        </div>

        <br><br>
        <button onclick="startSurvey()">Umfrage starten</button>
    </div>

    <!-- STEP 2: THE PARAGRAPHS -->
    <div id="step-survey" class="box hidden">
        <h3>Wurde dieser Text von einer KI geschrieben?</h3>
        <p style="font-size: 14px; color: gray;">Text <span id="q-num">1</span> von <span id="q-total"></span></p>
        
        <div class="text-display">
            <p id="paragraph-text">Laden...</p>
        </div>

        <button onclick="submitAnswer('AI')">Das ist KI</button>
        <button onclick="submitAnswer('NOT AI')">Das ist KEINE KI</button>
    </div>

    <!-- STEP 3: THANK YOU -->
    <div id="step-end" class="box hidden">
        <h2>Vielen Dank!</h2>
        <p>Deine Antworten wurden gespeichert.</p>
        <p>Du kannst das Fenster jetzt schließen.</p>
    </div>

    <script>
        // --- CONFIGURATION ---
        
        // WICHTIG: FÜGE HIER DEINE GOOGLE SCRIPT URL EIN (Zwischen die Anführungszeichen)
        const GOOGLE_SCRIPT_URL = "HIER_DEINE_GOOGLE_SCRIPT_URL_EINFÜGEN"; 

        // HIER SIND DIE TEXTE (isAI: true = KI, isAI: false = Mensch)
        const questions = [
            { 
                // ECHT 1
                text: `Es war einmal ein mutiges und kluges Eichhörnchen namens Svenja, das in einem wunderschönen Wald lebte.
Svenja war im ganzen Wald für ihr schnelles Denken und ihre Tapferkeit bekannt.
Und ebenso war sie immer bereit, ihren Freunden in der Not zu helfen.
Eines Tages war Svenja unterwegs, um Nüsse für den Winter zu sammeln, als sie ein seltsames Geräusch hörte, das von einem nahen Baum kam.
Sie kletterte auf den Baum, um nachzusehen, was da los war.
Dann sah sie eine Gruppe fieser Vögel, die einen kleinen, hilflosen Vogel ärgerten.
Svenja war sofort klar, dass sie eingreifen musste.
Also fasste sie schnell einen Plan.`, 
                isAI: false 
            },
            { 
                // KI 1
                text: `Es war einmal ein Eichhörnchen namens Svenja, das in einem großen Wald lebte. Sie war dafür bekannt, schnell zu denken und anderen Tieren zu helfen, wenn sie in Schwierigkeiten waren. Eines Tages sammelte sie wie gewohnt Nüsse für den Winter, als sie plötzlich ein seltsames Geräusch hörte. Neugierig kletterte sie auf einen Baum, um der Sache nachzugehen. Dort entdeckte sie mehrere Vögel, die einen kleineren Vogel bedrängten. Svenja erkannte sofort, dass die Situation unfair war. Ohne lange zu zögern, überlegte sie sich, wie sie eingreifen und dem schwächeren Tier helfen konnte.`, 
                isAI: true 
            },
            { 
                // KI 2
                text: `Ob soziale Medien für unter 16-Jährige eingeschränkt werden sollten, ist schwer zu beantworten. Einerseits gibt es dort viele negative Dinge wie Streit, Mobbing oder unrealistische Schönheitsideale. Gerade jüngere Jugendliche können dadurch unter Druck geraten. Andererseits sind soziale Netzwerke heute ganz normal und gehören für viele zum Alltag dazu. Wenn man sie zu stark einschränkt, fühlen sich Jugendliche vielleicht ausgeschlossen. Ich finde deshalb, dass klare Regeln und vielleicht bestimmte Altersgrenzen sinnvoll sind, aber kein komplettes Verbot. Wichtig ist vor allem, dass Jugendliche lernen, bewusst mit sozialen Medien umzugehen.`, 
                isAI: true 
            },
            { 
                // ECHT 2 (MENSCHEN 2)
                text: `Meiner Ansicht nach sollten soziale Medien für Jugendliche unter 16 nicht komplett verboten, aber stärker reguliert werden. In diesem Alter sind viele noch leicht beeinflussbar und vergleichen sich ständig mit anderen, was sich negativ auf das Selbstwertgefühl auswirken kann. Außerdem kommt es häufig zu Cybermobbing oder zum Kontakt mit unangemessenen Inhalten. Andererseits sind soziale Medien auch ein wichtiger Teil der heutigen Kommunikation. Jugendliche tauschen sich aus, informieren sich und bleiben mit Freunden in Verbindung. Deshalb halte ich klare Alterskontrollen und Zeitbegrenzungen für sinnvoller als ein generelles Verbot.`, 
                isAI: false 
            }
        ];

        // --- LOGIC ---
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let demographics = {};

        function checkOther() {
            const role = document.getElementById("role-select").value;
            const otherDiv = document.getElementById("other-input-div");
            if (role === "Other") {
                otherDiv.classList.remove("hidden");
            } else {
                otherDiv.classList.add("hidden");
            }
        }

        function startSurvey() {
            const role = document.getElementById("role-select").value;
            const otherText = document.getElementById("other-text").value;

            if (!role) { alert("Bitte wähle eine Option aus."); return; }
            if (role === "Other" && !otherText) { alert("Bitte gib an, was mit 'Sonstiges' gemeint ist."); return; }

            demographics = {
                role: role,
                otherDetail: role === "Other" ? otherText : ""
            };

            document.getElementById("step-demographics").classList.add("hidden");
            document.getElementById("step-survey").classList.remove("hidden");
            document.getElementById("q-total").innerText = questions.length;
            
            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentQuestionIndex];
            document.getElementById("paragraph-text").innerText = q.text;
            document.getElementById("q-num").innerText = currentQuestionIndex + 1;
        }

        function submitAnswer(selection) {
            const q = questions[currentQuestionIndex];
            
            // Record answer logic
            const isCorrect = (selection === 'AI' && q.isAI) || (selection === 'NOT AI' && !q.isAI);
            
            userAnswers.push({
                questionIndex: currentQuestionIndex,
                selection: selection,
                correct: isCorrect,
                isAI_actual: q.isAI // Saving what it actually was for reference
            });

            // Next question or Finish
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                finishSurvey();
            }
        }

        function finishSurvey() {
            document.getElementById("step-survey").classList.add("hidden");
            document.getElementById("step-end").classList.remove("hidden");

            // Calculate Results
            let correctCount = userAnswers.filter(a => a.correct).length;
            let percentage = (correctCount / questions.length) * 100;

            // Prepare payload
            const payload = {
                role: demographics.role,
                otherDetail: demographics.otherDetail,
                answers: userAnswers,
                score: correctCount + " / " + questions.length,
                percentage: percentage.toFixed(1) + "%"
            };

            // Send to Google Sheet
            if(GOOGLE_SCRIPT_URL.includes("HIER_DEINE")) {
                console.error("URL nicht gesetzt!");
                alert("Fehler: Die Datenbank-URL wurde nicht im Code hinterlegt.");
                return;
            }

            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // Important for Google Script
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            }).then(() => {
                console.log("Daten gesendet");
            }).catch(err => console.error(err));
        }
    </script>
</body>
</html>
